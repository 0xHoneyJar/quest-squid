type Quest @entity {
  id: ID!
  name: String! @index
  chain: String!
  steps: [QuestStep!]! @derivedFrom(field: "quest")
  startTime: Int
  endTime: Int
  totalParticipants: Int!
  totalCompletions: Int!
}

type QuestStep @entity {
  id: ID!
  quest: Quest!
  stepNumber: Int!
  type: String!
  address: String!
  tokenId: BigInt
  filterCriteria: JSON
  requiredAmount: BigInt!
  includeTransaction: Boolean!
}

type UserQuestProgress
  @entity
  @index(fields: ["id", "address"])
  @index(fields: ["id", "completed"]) {
  id: ID! @index
  address: String! @index
  quest: Quest!
  completedSteps: Int!
  completed: Boolean! @index
  stepProgresses: [StepProgress!]! @derivedFrom(field: "userQuestProgress")
}

type StepProgress @entity {
  id: ID!
  userQuestProgress: UserQuestProgress!
  stepNumber: Int!
  progressAmount: BigInt!
  completed: Boolean! @index
}

type Mission @entity {
  id: ID!
  name: String! @index
  chain: String!
  address: String!
  startTime: Int!
  startStreak: JSON!
  endStreak: JSON!
}

type UserMissionProgress @entity {
  id: ID!
  address: String! @index
  mission: Mission!
  lastActivationTimestamp: Int!
  lastStreakUpdateTimestamp: Int!
  currentStreak: Int!
  longestStreak: Int!
}
